version: '3.8'

services:
  typesense:
    image: typesense/typesense:0.25.2
    container_name: keepwatch-typesense
    restart: unless-stopped
    ports:
      - "8108:8108"
    environment:
      TYPESENSE_DATA_DIR: /data
      TYPESENSE_API_KEY: typesense-dev-key
      TYPESENSE_ENABLE_CORS: "true"
    volumes:
      - typesense-data:/data
    networks:
      - keepwatch-network

  firestore:
    image: gcr.io/google.com/cloudsdktool/google-cloud-cli:emulators
    container_name: keepwatch-firestore
    restart: unless-stopped
    ports:
      - "8080:8080" # Firestore emulator API port (no web UI with gcloud emulator)
    command: >
      gcloud emulators firestore start --host-port=0.0.0.0:8080
    environment:
      FIRESTORE_PROJECT_ID: keepwatch-dev
    networks:
      - keepwatch-network

  pubsub:
    image: gcr.io/google.com/cloudsdktool/google-cloud-cli:emulators
    container_name: keepwatch-pubsub
    restart: unless-stopped
    ports:
      - "8085:8085"
    command: >
      gcloud beta emulators pubsub start --project=keepwatch-dev --host-port=0.0.0.0:8085
    networks:
      - keepwatch-network

volumes:
  typesense-data:


networks:
  keepwatch-network:
    driver: bridge
